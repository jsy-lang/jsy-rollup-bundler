'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

function _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }

var util = require('util');
var fs = require('fs');
var path = require('path');
var chokidar = _interopDefault(require('chokidar'));

function asJSONServerSentEvents(res, subscriptionSet) {
  res.socket.setTimeout(0).setKeepAlive(true).setNoDelay(true);
  res.writeHead(200, {
    'Content-Type': 'text/event-stream',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive' });

  res.once('error', shutdown);
  res.once('close', shutdown);

  let write = res.write.bind(res);
  res = undefined;

  if (null != subscriptionSet) {
    subscriptionSet.add(sendJSONData);
  }

  write(`\n\n:sse ready\n\n`);
  return sendJSONData;

  function sendJSONData(obj) {
    if (undefined !== write) {
      write(`data: ${JSON.stringify(obj)}\n\n`);
      return true;
    }
  }

  function shutdown(...args) {
    write = undefined;
    if (null != subscriptionSet) {
      subscriptionSet.delete(sendJSONData);
    }
  }
}

const readFile$1 = util.promisify(fs.readFile);

const rx_data_live = /data-live-([a-z-]+)=(?:'([^']+)'|"([^"]+)")/g;
function replaceDataLive(webroot, data_live, source) {
  return source.replace(rx_data_live, (m, attr, val_a, val_b) => {
    const key = path.relative(webroot, path.join(webroot, val_a || val_b));
    return `${attr}='${data_live[key]}' data-live='${attr} ${key}'`;
  });
}

const renderDataLiveView = __express;
async function __express(filePath, locals, callback) {
  const { webroot, data_live } = locals.settings.data_live_info;
  try {
    const source = await readFile$1(filePath, 'utf-8');
    const res = await replaceDataLive(webroot, data_live, source);
    callback(null, res);
  } catch (err) {
    callback(err);
  }
}

function _initOptions(options) {
  if (!options) {
    options = {};
  }
  if (undefined === options.view) {
    options.view = true;
  }
  if (undefined === options.useProduction) {
    options.useProduction = 'production' == process.env.NODE_ENV;
  }
  return options;
}

function initExpressLiveLoader(app, webroot, options = {}) {
  options = _initOptions(options);
  const { useProduction } = options;

  const live_info = initLiveLoader(webroot, options);
  app.set('data_live_info', live_info);

  if (options.view) {
    if (true === options.view) {
      options.view = 'html';
      app.set('view engine', 'html');
    }

    app.engine(options.view, renderDataLiveView);
  }

  if (!useProduction) {
    app.get(options.endpoint || '/__live__', (req, res) => asJSONServerSentEvents(res, live_info.subscriptions));
  }

  return live_info;
}

function initLiveLoader(webroot, options) {
  options = _initOptions(options);
  const { useProduction } = options;

  const subscriptions = new Set();
  const production = {},
        development = {};

  const watcher = chokidar.watch(['*.lnk'], { cwd: webroot }).on('add', updateWatchedLnk).on('change', updateWatchedLnk);

  if (useProduction) {
    setTimeout(() => watcher.close(), 60000);
  }

  const self = Object.create(null, {
    subscriptions: { value: subscriptions },
    watcher: { value: watcher } });

  Object.assign(self, {
    webroot, production, development,
    data_live: useProduction ? production : development,
    useProduction });

  return self;

  function live_sendChange(obj) {
    for (const sendChange of subscriptions.values()) {
      sendChange(obj);
    }
  }

  async function updateWatchedLnk(fname) {
    const filePath = path.join(webroot, fname);
    const key = path.relative(webroot, filePath.replace(/.lnk$/, ''));
    const tgt = path.join(path.dirname(key), (await readFile$1(filePath, 'utf-8')));

    const minified = fname.includes('.min.');
    if (minified) {
      production[key] = tgt;
      production[key.replace('.min.', '.')] = tgt;
    } else if (tgt != development[key]) {
      development[key] = tgt;
      live_sendChange(development);
    }
  }
}

exports.asJSONServerSentEvents = asJSONServerSentEvents;
exports.rx_data_live = rx_data_live;
exports.replaceDataLive = replaceDataLive;
exports.renderDataLiveView = renderDataLiveView;
exports.__express = __express;
exports.initExpressLiveLoader = initExpressLiveLoader;
exports.initLiveLoader = initLiveLoader;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1zZXJ2ZXIuanMiLCJzb3VyY2VzIjpbIi4uL2NvZGUvc2VydmVyU2VudEV2ZW50cy5qc3kiLCIuLi9jb2RlL2xpdmUtc2VydmVyLmpzeSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhc0pTT05TZXJ2ZXJTZW50RXZlbnRzKHJlcywgc3Vic2NyaXB0aW9uU2V0KSA6OlxuICByZXMuc29ja2V0LnNldFRpbWVvdXQoMCkuc2V0S2VlcEFsaXZlKHRydWUpLnNldE5vRGVsYXkodHJ1ZSlcbiAgcmVzLndyaXRlSGVhZCBAIDIwMCwgQDpcbiAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvZXZlbnQtc3RyZWFtJ1xuICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJ1xuICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnXG5cbiAgcmVzLm9uY2UgQCAnZXJyb3InLCBzaHV0ZG93blxuICByZXMub25jZSBAICdjbG9zZScsIHNodXRkb3duXG5cbiAgbGV0IHdyaXRlID0gcmVzLndyaXRlLmJpbmQocmVzKVxuICByZXMgPSB1bmRlZmluZWRcblxuICBpZiBudWxsICE9IHN1YnNjcmlwdGlvblNldCA6OlxuICAgIHN1YnNjcmlwdGlvblNldC5hZGQgQCBzZW5kSlNPTkRhdGFcblxuICB3cml0ZSBAIGBcXG5cXG46c3NlIHJlYWR5XFxuXFxuYFxuICByZXR1cm4gc2VuZEpTT05EYXRhXG5cbiAgZnVuY3Rpb24gc2VuZEpTT05EYXRhKG9iaikgOjpcbiAgICBpZiB1bmRlZmluZWQgIT09IHdyaXRlIDo6XG4gICAgICB3cml0ZSBAIGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KG9iail9XFxuXFxuYFxuICAgICAgcmV0dXJuIHRydWVcblxuICBmdW5jdGlvbiBzaHV0ZG93biguLi5hcmdzKSA6OlxuICAgIHdyaXRlID0gdW5kZWZpbmVkXG4gICAgaWYgbnVsbCAhPSBzdWJzY3JpcHRpb25TZXQgOjpcbiAgICAgIHN1YnNjcmlwdGlvblNldC5kZWxldGUgQCBzZW5kSlNPTkRhdGFcblxuIiwiaW1wb3J0IHtwcm9taXNpZnl9IGZyb20gJ3V0aWwnXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcydcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBjaG9raWRhciBmcm9tICdjaG9raWRhcidcbmltcG9ydCBhc0pTT05TZXJ2ZXJTZW50RXZlbnRzIGZyb20gJy4vc2VydmVyU2VudEV2ZW50cy5qc3knXG5cbmNvbnN0IHJlYWRGaWxlID0gcHJvbWlzaWZ5IEAgZnMucmVhZEZpbGVcblxuZXhwb3J0IHthc0pTT05TZXJ2ZXJTZW50RXZlbnRzfVxuXG5leHBvcnQgY29uc3QgcnhfZGF0YV9saXZlID0gL2RhdGEtbGl2ZS0oW2Etei1dKyk9KD86JyhbXiddKyknfFwiKFteXCJdKylcIikvZ1xuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VEYXRhTGl2ZSh3ZWJyb290LCBkYXRhX2xpdmUsIHNvdXJjZSkgOjpcbiAgcmV0dXJuIHNvdXJjZS5yZXBsYWNlIEAgcnhfZGF0YV9saXZlLCAobSwgYXR0ciwgdmFsX2EsIHZhbF9iKSA9PiA6OlxuICAgIGNvbnN0IGtleSA9IHBhdGgucmVsYXRpdmUgQCB3ZWJyb290LFxuICAgICAgcGF0aC5qb2luIEAgd2Vicm9vdCwgdmFsX2EgfHwgdmFsX2JcbiAgICByZXR1cm4gYCR7YXR0cn09JyR7ZGF0YV9saXZlW2tleV19JyBkYXRhLWxpdmU9JyR7YXR0cn0gJHtrZXl9J2BcblxuXG5leHBvcnQgY29uc3QgcmVuZGVyRGF0YUxpdmVWaWV3ID0gX19leHByZXNzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX19leHByZXNzKGZpbGVQYXRoLCBsb2NhbHMsIGNhbGxiYWNrKSA6OlxuICBjb25zdCB7d2Vicm9vdCwgZGF0YV9saXZlfSA9IGxvY2Fscy5zZXR0aW5ncy5kYXRhX2xpdmVfaW5mb1xuICB0cnkgOjpcbiAgICBjb25zdCBzb3VyY2UgPSBhd2FpdCByZWFkRmlsZSBAIGZpbGVQYXRoLCAndXRmLTgnXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVwbGFjZURhdGFMaXZlIEAgd2Vicm9vdCwgZGF0YV9saXZlLCBzb3VyY2VcbiAgICBjYWxsYmFjayhudWxsLCByZXMpXG4gIGNhdGNoIGVyciA6OlxuICAgIGNhbGxiYWNrKGVycilcblxuXG5cbmZ1bmN0aW9uIF9pbml0T3B0aW9ucyhvcHRpb25zKSA6OlxuICBpZiAhIG9wdGlvbnMgOjogb3B0aW9ucyA9IHt9XG4gIGlmIHVuZGVmaW5lZCA9PT0gb3B0aW9ucy52aWV3IDo6XG4gICAgb3B0aW9ucy52aWV3ID0gdHJ1ZVxuICBpZiB1bmRlZmluZWQgPT09IG9wdGlvbnMudXNlUHJvZHVjdGlvbiA6OlxuICAgIG9wdGlvbnMudXNlUHJvZHVjdGlvbiA9ICdwcm9kdWN0aW9uJyA9PSBwcm9jZXNzLmVudi5OT0RFX0VOVlxuICByZXR1cm4gb3B0aW9uc1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdEV4cHJlc3NMaXZlTG9hZGVyKGFwcCwgd2Vicm9vdCwgb3B0aW9ucz17fSkgOjpcbiAgb3B0aW9ucyA9IF9pbml0T3B0aW9ucyhvcHRpb25zKVxuICBjb25zdCB7dXNlUHJvZHVjdGlvbn0gPSBvcHRpb25zXG5cbiAgY29uc3QgbGl2ZV9pbmZvID0gaW5pdExpdmVMb2FkZXIod2Vicm9vdCwgb3B0aW9ucylcbiAgYXBwLnNldCBAICdkYXRhX2xpdmVfaW5mbycsIGxpdmVfaW5mb1xuXG4gIGlmIG9wdGlvbnMudmlldyA6OlxuICAgIGlmIHRydWUgPT09IG9wdGlvbnMudmlldyA6OlxuICAgICAgb3B0aW9ucy52aWV3ID0gJ2h0bWwnXG4gICAgICBhcHAuc2V0IEAgJ3ZpZXcgZW5naW5lJywgJ2h0bWwnXG5cbiAgICBhcHAuZW5naW5lIEAgb3B0aW9ucy52aWV3LCByZW5kZXJEYXRhTGl2ZVZpZXdcblxuICBpZiAhIHVzZVByb2R1Y3Rpb24gOjpcbiAgICBhcHAuZ2V0IEAgb3B0aW9ucy5lbmRwb2ludCB8fCAnL19fbGl2ZV9fJywgKHJlcSwgcmVzKSA9PlxuICAgICAgYXNKU09OU2VydmVyU2VudEV2ZW50cyhyZXMsIGxpdmVfaW5mby5zdWJzY3JpcHRpb25zKVxuXG4gIHJldHVybiBsaXZlX2luZm9cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRMaXZlTG9hZGVyKHdlYnJvb3QsIG9wdGlvbnMpIDo6XG4gIG9wdGlvbnMgPSBfaW5pdE9wdGlvbnMob3B0aW9ucylcbiAgY29uc3Qge3VzZVByb2R1Y3Rpb259ID0gb3B0aW9uc1xuXG4gIGNvbnN0IHN1YnNjcmlwdGlvbnMgPSBuZXcgU2V0KClcbiAgY29uc3QgcHJvZHVjdGlvbiA9IHt9LCBkZXZlbG9wbWVudCA9IHt9XG5cbiAgY29uc3Qgd2F0Y2hlciA9IGNob2tpZGFyXG4gICAgLndhdGNoIEAgWycqLmxuayddLCBAOiBjd2Q6IHdlYnJvb3RcbiAgICAub24gQCAnYWRkJywgdXBkYXRlV2F0Y2hlZExua1xuICAgIC5vbiBAICdjaGFuZ2UnLCB1cGRhdGVXYXRjaGVkTG5rXG5cbiAgaWYgdXNlUHJvZHVjdGlvbiA6OlxuICAgIHNldFRpbWVvdXQgQCAoKSA9PiB3YXRjaGVyLmNsb3NlKCksIDYwMDAwXG5cbiAgY29uc3Qgc2VsZiA9IE9iamVjdC5jcmVhdGUgQCBudWxsLCBAe31cbiAgICBzdWJzY3JpcHRpb25zOiBAe30gdmFsdWU6IHN1YnNjcmlwdGlvbnNcbiAgICB3YXRjaGVyOiBAe30gdmFsdWU6IHdhdGNoZXJcblxuICBPYmplY3QuYXNzaWduIEAgc2VsZiwgQHt9XG4gICAgd2Vicm9vdCwgcHJvZHVjdGlvbiwgZGV2ZWxvcG1lbnRcbiAgICBkYXRhX2xpdmU6IHVzZVByb2R1Y3Rpb24gPyBwcm9kdWN0aW9uIDogZGV2ZWxvcG1lbnRcbiAgICB1c2VQcm9kdWN0aW9uXG5cbiAgcmV0dXJuIHNlbGZcblxuICBmdW5jdGlvbiBsaXZlX3NlbmRDaGFuZ2Uob2JqKSA6OlxuICAgIGZvciBjb25zdCBzZW5kQ2hhbmdlIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkgOjpcbiAgICAgIHNlbmRDaGFuZ2Uob2JqKVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVdhdGNoZWRMbmsoZm5hbWUpIDo6XG4gICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4od2Vicm9vdCwgZm5hbWUpXG4gICAgY29uc3Qga2V5ID0gcGF0aC5yZWxhdGl2ZSBAIHdlYnJvb3QsIGZpbGVQYXRoLnJlcGxhY2UoLy5sbmskLywgJycpXG4gICAgY29uc3QgdGd0ID0gcGF0aC5qb2luIEAgcGF0aC5kaXJuYW1lKGtleSksIGF3YWl0IHJlYWRGaWxlIEAgZmlsZVBhdGgsICd1dGYtOCdcblxuICAgIGNvbnN0IG1pbmlmaWVkID0gZm5hbWUuaW5jbHVkZXMoJy5taW4uJylcbiAgICBpZiBtaW5pZmllZCA6OlxuICAgICAgcHJvZHVjdGlvbltrZXldID0gdGd0XG4gICAgICBwcm9kdWN0aW9uW2tleS5yZXBsYWNlKCcubWluLicsJy4nKV0gPSB0Z3RcblxuICAgIGVsc2UgaWYgdGd0ICE9IGRldmVsb3BtZW50W2tleV0gOjpcbiAgICAgIGRldmVsb3BtZW50W2tleV0gPSB0Z3RcbiAgICAgIGxpdmVfc2VuZENoYW5nZSBAIGRldmVsb3BtZW50XG5cbiJdLCJuYW1lcyI6WyJhc0pTT05TZXJ2ZXJTZW50RXZlbnRzIiwicmVzIiwic3Vic2NyaXB0aW9uU2V0Iiwic29ja2V0Iiwic2V0VGltZW91dCIsInNldEtlZXBBbGl2ZSIsInNldE5vRGVsYXkiLCJ3cml0ZUhlYWQiLCJvbmNlIiwic2h1dGRvd24iLCJ3cml0ZSIsImJpbmQiLCJ1bmRlZmluZWQiLCJhZGQiLCJzZW5kSlNPTkRhdGEiLCJvYmoiLCJKU09OIiwic3RyaW5naWZ5IiwiYXJncyIsImRlbGV0ZSIsInJlYWRGaWxlIiwicHJvbWlzaWZ5IiwiZnMiLCJyeF9kYXRhX2xpdmUiLCJyZXBsYWNlRGF0YUxpdmUiLCJ3ZWJyb290IiwiZGF0YV9saXZlIiwic291cmNlIiwicmVwbGFjZSIsIm0iLCJhdHRyIiwidmFsX2EiLCJ2YWxfYiIsImtleSIsInBhdGgiLCJyZW5kZXJEYXRhTGl2ZVZpZXciLCJfX2V4cHJlc3MiLCJmaWxlUGF0aCIsImxvY2FscyIsImNhbGxiYWNrIiwic2V0dGluZ3MiLCJkYXRhX2xpdmVfaW5mbyIsImVyciIsIl9pbml0T3B0aW9ucyIsIm9wdGlvbnMiLCJ2aWV3IiwidXNlUHJvZHVjdGlvbiIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImluaXRFeHByZXNzTGl2ZUxvYWRlciIsImFwcCIsImxpdmVfaW5mbyIsImluaXRMaXZlTG9hZGVyIiwic2V0IiwiZW5naW5lIiwiZ2V0IiwiZW5kcG9pbnQiLCJyZXEiLCJzdWJzY3JpcHRpb25zIiwiU2V0IiwicHJvZHVjdGlvbiIsImRldmVsb3BtZW50Iiwid2F0Y2hlciIsImNob2tpZGFyIiwid2F0Y2giLCJjd2QiLCJvbiIsInVwZGF0ZVdhdGNoZWRMbmsiLCJjbG9zZSIsInNlbGYiLCJPYmplY3QiLCJjcmVhdGUiLCJ2YWx1ZSIsImFzc2lnbiIsImxpdmVfc2VuZENoYW5nZSIsInNlbmRDaGFuZ2UiLCJ2YWx1ZXMiLCJmbmFtZSIsInRndCIsIm1pbmlmaWVkIiwiaW5jbHVkZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQWUsU0FBU0Esc0JBQVQsQ0FBZ0NDLEdBQWhDLEVBQXFDQyxlQUFyQyxFQUFzRDtNQUMvREMsTUFBSixDQUFXQyxVQUFYLENBQXNCLENBQXRCLEVBQXlCQyxZQUF6QixDQUFzQyxJQUF0QyxFQUE0Q0MsVUFBNUMsQ0FBdUQsSUFBdkQ7TUFDSUMsU0FBSixDQUFnQixHQUFoQixFQUF1QjtvQkFDTCxtQkFESztxQkFFSixVQUZJO2tCQUdQLFlBSE8sRUFBdkI7O01BS0lDLElBQUosQ0FBVyxPQUFYLEVBQW9CQyxRQUFwQjtNQUNJRCxJQUFKLENBQVcsT0FBWCxFQUFvQkMsUUFBcEI7O01BRUlDLFFBQVFULElBQUlTLEtBQUosQ0FBVUMsSUFBVixDQUFlVixHQUFmLENBQVo7UUFDTVcsU0FBTjs7TUFFRyxRQUFRVixlQUFYLEVBQTZCO29CQUNYVyxHQUFoQixDQUFzQkMsWUFBdEI7OztRQUVP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
